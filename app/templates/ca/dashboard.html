{% extends 'ca/ca_base.html' %}
{% block title %}CA Dashboard | MyBillingApp{% endblock %}
{% block ca_content %}
<h2 class="text-2xl font-bold text-[#ed6a3e] mb-8">Welcome, {{ current_user.username }}!</h2>
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
  <!-- Summary Cards -->
  <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-start">
    <div class="text-gray-500 mb-1">Total Clients</div>
    <div class="text-3xl font-bold">{{ total_clients }}</div>
  </div>
  <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-start">
    <div class="text-gray-500 mb-1">New Connections</div>
    <div class="text-3xl font-bold">{{ new_connections }}</div>
  </div>
  <div class="bg-white rounded-xl shadow-md p-6 flex flex-col items-start">
    <div class="text-gray-500 mb-1">Pending Approvals</div>
    <div class="text-3xl font-bold">{{ pending_approvals }}</div>
  </div>
</div>
<!-- Recent Bills Table -->
<div class="bg-white rounded-xl shadow-md p-6 mb-8">
  <div class="flex justify-between items-center mb-4">
    <h3 class="font-semibold text-lg">Recent Bills Shared</h3>
    <a href="/ca/bills" class="text-[#ed6a3e] font-medium hover:underline">View All</a>
  </div>
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-gray-500">
          <th class="py-2 px-3">Shopkeeper</th>
          <th class="py-2 px-3">Bill #</th>
          <th class="py-2 px-3">Date</th>
          <th class="py-2 px-3">Amount</th>
          <th class="py-2 px-3">Status</th>
          <th class="py-2 px-3">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for bill in recent_bills %}
        <tr class="border-t">
          <td class="py-2 px-3">{{ bill.shopkeeper_name }}</td>
          <td class="py-2 px-3">{{ bill.bill_number }}</td>
          <td class="py-2 px-3">{{ bill.bill_date.strftime('%Y-%m-%d') }}</td>
          <td class="py-2 px-3">â‚¹{{ bill.total_amount }}</td>
          <td class="py-2 px-3">
            <span class="inline-block px-2 py-1 rounded text-xs font-semibold {% if bill.payment_status == 'Paid' %}bg-green-100 text-green-700{% elif bill.payment_status == 'Unpaid' %}bg-red-100 text-red-700{% else %}bg-yellow-100 text-yellow-700{% endif %}">{{ bill.payment_status }}</span>
          </td>
          <td class="py-2 px-3 space-x-2">
            <a href="/bills/view/{{ bill.bill_id }}" class="text-blue-500 hover:underline">View</a>
            <a href="/bills/download/{{ bill.bill_id }}" class="text-[#ed6a3e] hover:underline">Download</a>
            <a href="/bills/export/{{ bill.bill_id }}" class="text-green-500 hover:underline">Export</a>
          </td>
        </tr>
        {% else %}
        <tr><td colspan="6" class="py-4 text-center text-gray-400">No recent bills found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<!-- Export to Tally Card -->
<div class="bg-gradient-to-r from-[#ed6a3e] to-[#ed6a3e] rounded-xl shadow-md p-6 flex items-center justify-between">
  <div>
    <div class="text-white text-lg font-semibold mb-1">Export All Bills</div>
    <div class="text-white/80">Download all bills in Excel/Tally format for accounting.</div>
  </div>
  <a href="/ca/export/all" class="bg-white text-[#ed6a3e] font-bold px-6 py-2 rounded-xl shadow hover:bg-gray-100 transition duration-300">Export</a>
</div>
{% endblock %} 